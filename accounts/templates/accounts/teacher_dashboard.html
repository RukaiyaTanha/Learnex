{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teacher Dashboard</title>
<link rel="stylesheet" href="{% static 'accounts/dashboard4.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
<div class="container dashboard-container">
  <div class="header-section">
    <div class="welcome-message">
      <h1>Hi {{ username }},</h1>
      <p id="teacherMessage"></p>
    </div>

    <div class="profile-section">
      <a href="{% url 'profile_page' %}" class="profile-info-link">
        <div class="profile-icon">
          {% if user.profile_picture %}
              <img src="{{ user.profile_picture.url }}" alt="Profile Picture" class="dashboard-profile-pic">
          {% else %}
              <i class="fas fa-user-graduate"></i>
          {% endif %}
        </div>
        <div class="profile-info">
          <span class="profile-name">{{ username }}</span>
          <span class="profile-role">{{ role }}</span>
        </div>
      </a>
      <button id="logoutBtn" class="logout-btn" title="Logout">
        <i class="fas fa-sign-out-alt"></i>
      </button>
    </div>
  </div>
  <div class="dashboard-grid">
    <div class="dashboard-card">
      <a href="{% url 'teacher_course_selection_page' %}" class="card-link">
        <div class="card-icon"><i class="fas fa-book-open"></i></div>
        <h3>Choose your course names</h3>
        <p>Manage and assign the subjects you’ll be teaching this semester.</p>
        <div class="card-action"><span>Let's go</span><i class="fas fa-arrow-right"></i></div>
      </a>
    </div>

    <div class="dashboard-card">
      <a href="{% url 'upload_student_info_page' %}" class="card-link">
        <div class="card-icon"><i class="fas fa-users"></i></div>
        <h3>Add the section and student informations</h3>
        <p>Create or update class sections and student details for quizzes and lessons.</p>
        <div class="card-action"><span>Let's go</span><i class="fas fa-arrow-right"></i></div>
      </a>
    </div>

    <div class="dashboard-card">
      <a href="{% url 'teacher_post_marks_page' %}" class="card-link">
        <div class="card-icon"><i class="fas fa-clipboard-check"></i></div>
        <h3>Post student class marks</h3>
        <p>Upload and manage student scores for each course or section.</p>
        <div class="card-action"><span>Let's go</span><i class="fas fa-arrow-right"></i></div>
      </a>
    </div>

    <div class="dashboard-card">
      <a href="{% url 'teacher_view_performance' %}" class="card-link">
        <div class="card-icon"><i class="fa-chart-line"></i></div>
        <h3>View student performance</h3>
        <p>Analyze how students are performing and identify areas for improvement.</p>
        <div class="card-action"><span>Let's go</span><i class="fas fa-arrow-right"></i></div>
      </a>
    </div>
    <!--
    <div class="dashboard-card">
      <a href="{% url 'teacher_upload_syllabus' %}" class="card-link">
        <div class="card-icon"><i class="fas fa-file-upload"></i></div>
        <h3>Upload your course syllabus</h3>
        <p>Share your course outline and objectives with students easily.</p>
        <div class="card-action"><span>Let's go</span><i class="fas fa-arrow-right"></i></div>
      </a>
    </div>
  -->
    <div class="dashboard-card">
    <a href="{% url 'teacher_upload_syllabus' %}" class="card-link">
      <div class="card-icon"><i class="fas fa-file-signature"></i></div>
      <h3>Post course notes and assessments</h3>
      <p>Share your course outline, study materials, notes, and assessments to support student learning.</p>
      <div class="card-action"><span>Let's go</span><i class="fas fa-arrow-right"></i></div>
    </a>
    </div>

    <!--
    <div class="dashboard-card">
    <a href="#" class="card-link">
      <div class="card-icon"><i class="fas fa-robot"></i></div>
      <h3>Make question using AI</h3>
      <p>Generate quizzes and practice questions automatically using AI tools.</p>
      <div class="card-action"><span>Let's go</span><i class="fas fa-arrow-right"></i></div>
    </a>
    </div>  -->
  </div>

  <!-- Navigation Footer -->
  <div class="navigation-footer">
    <a href="#" class="nav-link active"><i class="fas fa-home"></i><span>Home</span></a>
    <a href="#" class="nav-link"><i class="fas fa-calendar-alt"></i><span>Schedule</span></a>
    <a href="#" class="nav-link"><i class="fas fa-envelope"></i><span>Messages</span></a>
    <a href="#" class="nav-link"><i class="fas fa-chart-bar"></i><span>Progress</span></a>
    <a href="#" class="nav-link"><i class="fas fa-cog"></i><span>Settings</span></a>
  </div>
</div>
<div id="settingsSidebar" class="settings-sidebar">
  <div class="settings-header">
    <h3>Settings</h3>
    <button id="closeSettings" class="close-btn"><i class="fas fa-times"></i></button>
  </div>
  <ul class="settings-list">
    <li class="dark-toggle"><i class="fas fa-moon"></i><span> Dark Mode</span></li>
    <li><i class="fas fa-bell"></i> Notifications</li>
    <li><i class="fas fa-lock"></i> Privacy & Security</li>
    <li><i class="fas fa-language"></i> Language</li>
    <li><i class="fas fa-user-cog"></i> Account Settings</li>
  </ul>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {

  const icon = document.querySelector('.nav-link i.fa-cog');
  const settingsNav = icon ? icon.closest('.nav-link') : null;
  const sidebar = document.getElementById('settingsSidebar');
  const closeBtn = document.getElementById('closeSettings');

  if (settingsNav && sidebar) {
    settingsNav.addEventListener('click', e => {
      e.preventDefault();
      sidebar.classList.toggle('open');
    });

    closeBtn?.addEventListener('click', () => sidebar.classList.remove('open'));
    document.addEventListener('keydown', e => e.key === 'Escape' && sidebar.classList.remove('open'));
    document.addEventListener('click', e => {
      if (!sidebar.classList.contains('open')) return;
      if (sidebar.contains(e.target) || settingsNav.contains(e.target)) return;
      sidebar.classList.remove('open');
    });
  }

  const teacherMessages = [
    "Welcome back! Let’s inspire students and make this class a success.",
    "I hope you’re having a great day. Let’s guide your students toward excellence.",
    "Ready to teach, track, and empower your students for better performance.",
    "Let’s shape learning with data-driven insights and smart teaching tools.",
    "Another great day to help your students achieve their best!",
    "Let’s make learning meaningful and measurable today.",
    "Empower. Educate. Excel — let’s start teaching with impact!"
  ];

  const randomMessage = teacherMessages[Math.floor(Math.random() * teacherMessages.length)];
  const teacherMsgEl = document.getElementById("teacherMessage");
  if (teacherMsgEl) teacherMsgEl.textContent = randomMessage;

  const darkToggle = document.querySelector('.dark-toggle');
  const body = document.body;
  const savedTheme = localStorage.getItem('theme');
  if (savedTheme === 'dark') {
    body.classList.add('dark-mode');
    darkToggle.querySelector('i').classList.replace('fa-moon', 'fa-sun');
    darkToggle.querySelector('span').textContent = ' Light Mode';
  }

  darkToggle.addEventListener('click', () => {
    const isDark = body.classList.toggle('dark-mode');
    if (isDark) {
      localStorage.setItem('theme', 'dark');
      darkToggle.querySelector('i').classList.replace('fa-moon', 'fa-sun');
      darkToggle.querySelector('span').textContent = ' Light Mode';
    } else {
      localStorage.setItem('theme', 'light');
      darkToggle.querySelector('i').classList.replace('fa-sun', 'fa-moon');
      darkToggle.querySelector('span').textContent = ' Dark Mode';
    }
  });

  const logoutBtn = document.getElementById('logoutBtn');
  logoutBtn.addEventListener('click', async function () {
    const confirmed = confirm("Are you sure you want to log out?");
    if (!confirmed) return;

    const response = await fetch("{% url 'logout_api' %}", {
      method: "POST",
      headers: {
        "X-CSRFToken": getCookie("csrftoken"),
      },
    });
    const data = await response.json();

    if (data.success) {
      alert("Logged out successfully!");
      window.location.href = "{% url 'login_page' %}";
    } else {
      alert("Logout failed: " + data.message);
    }
  });

  function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
      const cookies = document.cookie.split(';');
      for (let i = 0; i < cookies.length; i++) {
        const cookie = cookies[i].trim();
        if (cookie.substring(0, name.length + 1) === (name + '=')) {
          cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
          break;
        }
      }
    }
    return cookieValue;
  }
});
</script>
</body>
</html>
